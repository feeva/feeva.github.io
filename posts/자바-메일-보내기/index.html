<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>자바에서 메일 보내는 방법 - Nothing New Under the Sun</title>

    <meta name="description" content="최근에 우리 회사 새내기 개발자가 e메일 보내기에 대해 약간이나마 어려움을 느낀 것 같길래 자바에서 e메일 보내는 방법을 다시 한번 정리해볼 필요가 있겠다는 생각이 들었다. 이 글에서는 JavaMail API, 스프링 API, 기타 방법으로 e메일을 발신하는 방법을 알아보기로 한다. 자바 메일 보내기">
    <link rel="canonical" href="https://feeva.github.io/posts/자바-메일-보내기/">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="자바에서 메일 보내는 방법">
    <meta property="og:url" content="https://feeva.github.io/posts/자바-메일-보내기/">
    <meta property="og:description" content="최근에 우리 회사 새내기 개발자가 e메일 보내기에 대해 약간이나마 어려움을 느낀 것 같길래 자바에서 e메일 보내는 방법을 다시 한번 정리해볼 필요가 있겠다는 생각이 들었다. 이 글에서는 JavaMail API, 스프링 API, 기타 방법으로 e메일을 발신하는 방법을 알아보기로 한다. 자바 메일 보내기">
    <meta property="og:image" content="">
    <meta property="og:type" content="article">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Noto+Serif+KR:wght@300;400;500;600;700&family=Open+Sans:ital,wght@0,400;0,500;0,600;0,700;0,800;1,400;1,500;1,600;1,700;1,800&family=Roboto+Mono:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css">
    <link rel="stylesheet" href="/static/style.css">
    <style></style>
    <link rel="icon" href="/static/images/masi.jpg" />

    

    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-13042476-6', 'auto');
      ga('send', 'pageview');
    </script>
    
  </head>
  <body>
    <div class="post-layout">
  <a href="/" class="home-link">전체 게시물</a>

  <h1>자바에서 메일 보내는 방법</h1>

  <div class="post-content">
    <p>최근에 우리 회사 새내기 개발자가 e메일 보내기에 대해 약간이나마 어려움을 느낀 것 같길래 자바에서 e메일 보내는 방법을 다시 한번 정리해볼 필요가 있겠다는 생각이 들었다. 이 글에서는 JavaMail API, 스프링 API, 기타 방법으로 e메일을 발신하는 방법을 알아보기로 한다. <span style="display: none;">자바 메일 보내기</span><!--more--></p>
<h3>1. JavaMail API 사용</h3>
<p>이 방법은 자바 EE의 JavaMail API를 사용하는 것이다. 웹 환경에서는 제우스(Jeus)나 웹스피어(WebSphere) 같은 자바 EE 컨테이너를 사용한다면 JavaMail 라이브러리가 기본적으로 포함됐으므로 바로 사용할 수 있고 톰캣(Tomcat) 같은 서블릿 컨테이너를 사용하는 환경이거나 웹 환경이 아니라면 <a title="JavaMail API 다운로드" href="http://www.oracle.com/technetwork/java/javamail/index-138643.html" target="_blank">Oracle 사이트</a>에서 JavaMail API를 다운로드하거나 Maven pom.xml에 다음 의존성을 추가한다. (1.4.7이 현재 가장 안정적인 최신 버전이다.)</p>
<pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.mail<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mail<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.4.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre>
<p>주의할 것은 JavaMail API를 다운로드해서 사용하는 경우 자바 5나 그 미만의 환경이라면 <a title="JavaBeans Activation Framework 다운로드" href="http://www.oracle.com/technetwork/java/javase/downloads/index-135046.html" target="_blank">JavaBeans Activation Framework</a>도 다운로드해야 한다. 준비됐으면 다음 예제와 같이 자바 프로그램에서 메일을 보낼 수 있다.</p>
<pre class="language-java"><code class="language-java"><span class="token comment">// 먼저 환경 정보를 설정해야 한다.</span><br><span class="token comment">// 메일 서버 주소를 IP 또는 도메인 명으로 지정한다.</span><br><span class="token class-name">Properties</span> props <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>props<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"mail.smtp.host"</span><span class="token punctuation">,</span> <span class="token string">"111.222.33.44"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// 위 환경 정보로 "메일 세션"을 만들고 빈 메시지를 만든다</span><br><span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">Session</span><span class="token punctuation">.</span><span class="token function">getDefaultInstance</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token class-name">MimeMessage</span> msg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MimeMessage</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">try</span> <span class="token punctuation">{</span><br>    <span class="token comment">// 발신자, 수신자, 참조자, 제목, 본문 내용 등을 설정한다</span><br>    msg<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InternetAddress</span><span class="token punctuation">(</span><span class="token string">"aaa@bbb.co.kr"</span><span class="token punctuation">,</span> <span class="token string">"김유신"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    msg<span class="token punctuation">.</span><span class="token function">addRecipient</span><span class="token punctuation">(</span><span class="token class-name">Message<span class="token punctuation">.</span>RecipientType</span><span class="token punctuation">.</span><span class="token constant">TO</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">InternetAddress</span><span class="token punctuation">(</span><span class="token string">"ccc@ddd.co.kr"</span><span class="token punctuation">,</span> <span class="token string">"연개소문"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    msg<span class="token punctuation">.</span><span class="token function">addRecipient</span><span class="token punctuation">(</span><span class="token class-name">Message<span class="token punctuation">.</span>RecipientType</span><span class="token punctuation">.</span><span class="token constant">TO</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">InternetAddress</span><span class="token punctuation">(</span><span class="token string">"eee@fff.co.kr"</span><span class="token punctuation">,</span> <span class="token string">"선덕여왕"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    msg<span class="token punctuation">.</span><span class="token function">addRecipient</span><span class="token punctuation">(</span><span class="token class-name">Message<span class="token punctuation">.</span>RecipientType</span><span class="token punctuation">.</span><span class="token constant">CC</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">InternetAddress</span><span class="token punctuation">(</span><span class="token string">"ggg@hhh.co.kr"</span><span class="token punctuation">,</span> <span class="token string">"의자왕"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    msg<span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span><span class="token string">"제목이 이러저러합니다"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    msg<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span><span class="token string">"본문이 어쩌구저쩌구합니다"</span><span class="token punctuation">,</span> <span class="token string">"text/html; charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// 메일을 발신한다</span><br>    <span class="token class-name">Transport</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// 적절히 처리</span><br><span class="token punctuation">}</span></code></pre>
<p>위에서 17행을 보면 내용 형식을 text/html로 설정했기 때문에 내용이 html로 들어가야 한다. text/plain으로 하면 html 태그가 없는 평문으로 작성하면 된다. 그리고 문자셋은 utf-8로 했는데 ks_c_5601-1987이나 euc-kr도 일반적으로 사용되는 문자셋이다. 보다 세밀한 기능을 사용하려면 <a title="JavaMail API" href="https://javamail.java.net/nonav/docs/api/" target="_blank">API 문서</a>에서 각 클래스의 생성자나 메서드를 잘 살펴보기 바란다. 로깅 기능이나 파일 첨부 등 다양한 기능을 추가할 수 있다. 예를 들어 파일 첨부는 다음과 같이 가능하다. 위 17행 대신 들어갈 내용이다.</p>
<pre class="language-java"><code class="language-java"><span class="token class-name">MimeMultipart</span> multipart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MimeMultipart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token class-name">MimeBodyPart</span> part <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MimeBodyPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>part<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span><span class="token string">"본문이 어쩌구저쩌구합니다"</span><span class="token punctuation">,</span> <span class="token string">"text/html; charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>multipart<span class="token punctuation">.</span><span class="token function">addBodyPart</span><span class="token punctuation">(</span>part<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>part <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MimeBodyPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token class-name">FileDataSource</span> fds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileDataSource</span><span class="token punctuation">(</span><span class="token string">"파일 경로"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>part<span class="token punctuation">.</span><span class="token function">setDataHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DataHandler</span><span class="token punctuation">(</span>fds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>part<span class="token punctuation">.</span><span class="token function">setFileName</span><span class="token punctuation">(</span><span class="token string">"파일명"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>multipart<span class="token punctuation">.</span><span class="token function">addBodyPart</span><span class="token punctuation">(</span>part<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>msg<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span>multipart<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h3>2. Spring API 사용</h3>
<p>스프링 프레임웍을 사용한다면 위의 JavaMail API를 래핑(wrapping)한 클래스를 사용해 약간 더 간편하게 e메일을 보낼 수 있다. (래핑 개념이므로 JavaMail API는 결국 클래스 경로에 잡혀 있어야 한다. 1번 방법의 앞 부분을 다시 보라~) 간단한 예시는 다음과 같다. 텍스트 메일을 보내는 경우다.</p>
<pre class="language-java"><code class="language-java"><span class="token comment">// Spring의 메일 발신 클래스를 하나 선언하고 서버 정보를 설정한다.</span><br><span class="token class-name">JavaMailSenderImpl</span> mailSender <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JavaMailSenderImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>mailSender<span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">"111.222.33.44"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// 메일 내용을 작성한다</span><br><span class="token class-name">SimpleMailMessage</span> msg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleMailMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>msg<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span><span class="token string">"aaa@bbb.co.kr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>msg<span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token string">"ccc@ddd.co.kr"</span><span class="token punctuation">,</span> <span class="token string">"eee@fff.co.kr"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>msg<span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span><span class="token string">"제목이 이러저러합니다"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>msg<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"본문이 어쩌구저쩌구합니다"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">try</span> <span class="token punctuation">{</span><br>    mailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">MailException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// 적절히 처리</span><br><span class="token punctuation">}</span></code></pre>
<p>위에서 2, 3행의 메일 발신 클래스 선언은 환경 설정에 해당하므로 스프링의 개념에서는 의존성 주입(dependency injection) 방식으로 처리하는 것이 맞다. 즉,</p>
<pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Autowired</span><br><span class="token keyword">private</span> <span class="token class-name">JavaMailSender</span> mailSender<span class="token punctuation">;</span></code></pre>
<p>와 같이 외부에서 인스턴스를 생성해 받는 것이 보다 스프링적인 방법이다. 아무튼 이 방법 역시 <a title="스프링 프레임웍 API" href="http://docs.spring.io/spring/docs/3.2.4.RELEASE/javadoc-api/" target="_blank">API 문서</a>나 <a title="스프링 프레임웍 e메일" href="http://docs.spring.io/spring/docs/3.2.4.RELEASE/spring-framework-reference/html/mail.html" target="_blank">설명서</a>를 참고하면 보다 복잡한 기능을 사용할 수 있다. 다음은 첨부 파일을 넣는 경우다.</p>
<pre class="language-java"><code class="language-java"><span class="token class-name">MimeMessage</span> msg <span class="token operator">=</span> mailSender<span class="token punctuation">.</span><span class="token function">createMimeMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token class-name">MimeMessageHelper</span> helper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MimeMessageHelper</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>helper<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InternetAddress</span><span class="token punctuation">(</span><span class="token string">"aaa@bbb.co.kr"</span><span class="token punctuation">,</span> <span class="token string">"김유신"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>helper<span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InternetAddress</span><span class="token punctuation">(</span><span class="token string">"ccc@ddd.co.kr"</span><span class="token punctuation">,</span> <span class="token string">"연개소문"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>helper<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"본문이 어쩌구저쩌구합니다"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true는 HTML 내용인 경우고 false는 평문 내용인 경우다</span><br>helper<span class="token punctuation">.</span><span class="token function">addAttachment</span><span class="token punctuation">(</span><span class="token string">"파일명"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"파일 경로"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h3>3. 기타 방법</h3>
<p>아파치 커먼스(Apache Commons) 프로젝트 중에 Email 프로젝트를 사용해서 메일을 보낼 수 있다. 이 역시 JavaMail API를 래핑한 것이라 JavaMail 라이브러리는 필수다. 사용 방법은 프로젝트의 <a title="Apache Commons Email 사용 설명" href="http://commons.apache.org/proper/commons-email/userguide.html" target="_blank">설명 문서</a>를 참고하기 바란다. 마지막으로 <a title="Apache Commons Net" href="http://commons.apache.org/proper/commons-net/" target="_blank">아파치 커먼스 Net</a> 같은 프로젝트를 활용해서 SMTP 프로토콜을 직접 제어하는 방법도 있다. 이 방법은 위의 방법들보다 훨씬 복잡하지만 SMTP를 거의 직접적으로 제어하는 수준으로 메일을 발신할 수 있으므로 오류 처리라든가 대량 메일 발신 등의 처리에 있어서 개발자 고유의 로직을 적용할 수 있는 장점이 있다. 사용 방법 예시로 <a title="Apache Commons Net SMTP 예시" href="http://commons.apache.org/proper/commons-net/examples/mail/SMTPMail.java" target="_blank">자바 파일</a>이 있으므로 참고해볼만 하다.</p>

  </div>

  <div class="post-footer">
    <div class="post-footer-date">
      게시일 - <time datetime="2013-09-29T16:53:54.000Z">2013. 9. 30.</time>
    </div>

    <ul class="post-tags"><li><a href="/tags/e메일">e메일</a></li><li><a href="/tags/메일">메일</a></li><li><a href="/tags/spring">Spring</a></li><li><a href="/tags/스프링">스프링</a></li><li><a href="/tags/javamail">JavaMail</a></li><li><a href="/tags/apache">Apache</a></li></ul>
  </div>
</div>

<div id="disqus_thread"></div>
<script>
  /**
  *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
  var disqus_config = function () {
    this.page.url = "http://start.goodtime.co.kr/2013/09/%ec%9e%90%eb%b0%94-%eb%a9%94%ec%9d%bc-%eb%b3%b4%eb%82%b4%ea%b8%b0/" || location.origin + '/posts/자바-메일-보내기/';
    this.page.identifier = '자바-메일-보내기';
  };
  (function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = 'https://nnus.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  })();
</script>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.js"></script>

    <script type="module" src="/static/modules/blogInit.js"></script>
    
  </body>
</html>
