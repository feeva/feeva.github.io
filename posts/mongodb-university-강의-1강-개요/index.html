<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MongoDB University 강의 1강 - 개요 - Nothing New Under the Sun</title>

    <meta name="description" content="MongoDB University에서 자바 개발자를 위한 MongoDB 강좌를 들었다. 시작한지 꽤 됐지만 바쁜 핑계로 아직도 끝내진 못했는데 정리 삼아 올려본다. 서너달에 한번씩 여러 강좌를 순환하므로 관심있다면 수강해보길 권한다.">
    <link rel="canonical" href="/posts/mongodb-university-강의-1강-개요/">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="MongoDB University 강의 1강 - 개요">
    <meta property="og:url" content="/posts/mongodb-university-강의-1강-개요/">
    <meta property="og:description" content="MongoDB University에서 자바 개발자를 위한 MongoDB 강좌를 들었다. 시작한지 꽤 됐지만 바쁜 핑계로 아직도 끝내진 못했는데 정리 삼아 올려본다. 서너달에 한번씩 여러 강좌를 순환하므로 관심있다면 수강해보길 권한다.">
    <meta property="og:image" content="">
    <meta property="og:type" content="article">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Noto+Serif+KR:wght@300;400;500;600;700&family=Open+Sans:ital,wght@0,400;0,500;0,600;0,700;0,800;1,400;1,500;1,600;1,700;1,800&family=Roboto+Mono:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css">
    <link rel="stylesheet" href="/static/style.css">
    <style></style>
    <link rel="icon" href="/static/images/masi.jpg" />

    

    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-13042476-6', 'auto');
      ga('send', 'pageview');
    </script>
    
  </head>
  <body>
    <div class="post-layout">
  <a href="/" class="home-link">전체 게시물</a>

  <h1>MongoDB University 강의 1강 - 개요</h1>

  <div class="post-content">
    <p><a href="https://university.mongodb.com/" target="_blank">MongoDB University</a>에서 <a title="M101J: MongoDB for Java Developers" href="https://university.mongodb.com/courses/10gen/M101J/2014_August/about" target="_blank">자바 개발자를 위한 MongoDB 강좌</a>를 들었다. 시작한지 꽤 됐지만 바쁜 핑계로 아직도 끝내진 못했는데 정리 삼아 올려본다. 서너달에 한번씩 여러 강좌를 순환하므로 관심있다면 수강해보길 권한다.</p>
<!--more-->
<h3>MongoDB 개념</h3>
<p>NoSQL 데이터베이스로서 JSON 형태의 데이터를 저장한다. SQL을 지원하지 않기 때문에 조인 개념이 없고 스키마는 유동적이다. 유동적이라는 말은 MongoDB에서 저장하는 데이터 단위는 &quot;문서&quot;인데 관계형 데이터베이스에서 행 단위의 레코드라고 할 수 있다. 하지만 문서의 속성은 DB 컬럼처럼 정형화된 것이 아니라 가변적이라 모든 문서의 형태는 다를 수 있다는 것이다.</p>
<p>다른 개념으로 말하자면 문서 지향 (Document Oriented) 데이터베이스다. 문서를 집합적으로 부르는 명칭은 &quot;컬렉션&quot;이다.(관계형 DB에서의 테이블에 대응되는 개념)</p>
<pre><code>규모확장성 및 성능
^
| * memcached
| * Key-value store * MongoDB
|
|
|
|                     * RDBMS
+-------------------------------&gt; 기능 깊이

- 확장성/성능 대비 기능에 대한 도표
</code></pre>
<p>RDBMS는 우수한 하드웨어를 확장해야만 실질적인 성능 향상이 있는데 MongoDB는 memcached보다는 기능이 많으면서 RDBMS보다는 성능이 우수한 것을 목표로 한다.</p>
<p>MongoDB는 1. 성능을 위해 조인 기능은 포기했고 2. 트랜잭션 없으나 문서가 계층화돼 있고 문서를 atomic하게 처리할 수 있으므로 트랜잭션과 유사한 효과가 있다. 여러 문서간에 걸친 트랜잭션을 지원하지는 않는다.</p>
<h3>애플리케이션 개발 개요</h3>
<p>본 강의에서는 블로그를 개발해보기로 한다. 다음은 개략적인 아키텍처다. (클릭하면 내가 열심히 다시 그린 그림 팝업!)</p>
<div class="image-block">
<p><figure><picture><source type="image/webp" srcset="/static/resp-img/w9T1dU1sUw-360.webp 360w, /static/resp-img/w9T1dU1sUw-720.webp 720w, /static/resp-img/w9T1dU1sUw-800.webp 800w" sizes="(max-width:800px) 100vw, 1200px"><source type="image/jpeg" srcset="/static/resp-img/w9T1dU1sUw-360.jpeg 360w, /static/resp-img/w9T1dU1sUw-720.jpeg 720w, /static/resp-img/w9T1dU1sUw-800.jpeg 800w" sizes="(max-width:800px) 100vw, 1200px"><img alt="MongoDB 앱 아키텍처" loading="lazy" decoding="async" data-src="../../static/uploads/2014/07/mongo_app_architecture.png" src="/static/resp-img/w9T1dU1sUw-360.jpeg" width="800" height="427"></picture><figcaption>MongoDB 앱 아키텍처</figcaption></figure></p>
</div>
<p>MongoDB 자바 드라이버를 통해 데이터를 처리하고 사용자에게 웹페이지를 보이는 방식이다. 웹 개발용 프레임웍으로는 Spark, Freemarker를 사용하기로 한다.</p>
<h3>시스템 요구 사항 및 설치</h3>
<ul>
<li>JDK 1.6 이나 1.7이 필요하다.</li>
<li><a title="MongoDB 다운로드" href="http://www.mongodb.org/downloads" target="_blank">MongoDB 사이트</a>에서 다운로드한 다음 실행만 하면 간단히 설치된다.</li>
<li>설치 폴더에서 mongod.exe를 실행하면 명령 프롬프트로 데이터베이스 서버가 실행된다. 이제 mongo.exe 셸 프로그램으로 연결하거나 Mongo 자바 드라이버를 통해 프로그램적으로 연결해 사용할 수 있다.</li>
</ul>
<h3>Spark 프레임웍</h3>
<p>간단한 웹프레임웍으로서 “라우트” 개념으로 웹요청 주소를 Java 클래스/메서드에 대응시킨다. 다음은 예제다.</p>
<pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token class-name">Spark</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Route</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token annotation punctuation">@Override</span><br>        <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">Request</span> request<span class="token punctuation">,</span><br>                             <span class="token keyword">final</span> <span class="token class-name">Response</span> response<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">return</span> <span class="token string">"Hello World From Spark\n"</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<h3>Freemarker</h3>
<p>템플리팅 엔진으로서 템플릿 파일 내용의 변수나 조건문, 루프 등을 데이터로 치환할 수 있다. 웹과는 무관하게 사용할 수 있는 엔진이다. 다음은 예제다.</p>
<pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token class-name">Configuration</span> configuration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    configuration<span class="token punctuation">.</span><span class="token function">setClassForTemplateLoading</span><span class="token punctuation">(</span><br>            <span class="token class-name">HelloWorldFreemarkerStyle</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">try</span> <span class="token punctuation">{</span><br>        <span class="token class-name">Template</span> helloTemplate <span class="token operator">=</span> configuration<span class="token punctuation">.</span><span class="token function">getTemplate</span><span class="token punctuation">(</span><span class="token string">"hello.ftl"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 템플릿 파일 로드</span><br>        <span class="token class-name">StringWriter</span> writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> helloMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        helloMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"Freemarker"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>        helloTemplate<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>helloMap<span class="token punctuation">,</span> writer<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>writer<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>다음은 <code>hello.ftl</code> 템플릿 파일이다.</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Welcome!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Hello ${name}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre>
<h3>Spark + Freemarker + MongoDB</h3>
<p>이제 세 가지를 혼합한 예제를 보자.</p>
<pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UnknownHostException</span> <span class="token punctuation">{</span><br>    <span class="token keyword">final</span> <span class="token class-name">Configuration</span> configuration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    configuration<span class="token punctuation">.</span><span class="token function">setClassForTemplateLoading</span><span class="token punctuation">(</span><br>            <span class="token class-name">HelloWorldSparkFreemarkerStyle</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token class-name">MongoClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MongoClient</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ServerAddress</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token number">27017</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token class-name">DB</span> database <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">getDB</span><span class="token punctuation">(</span><span class="token string">"course"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">final</span> <span class="token class-name">DBCollection</span> collection <span class="token operator">=</span> database<span class="token punctuation">.</span><span class="token function">getCollection</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token class-name">Spark</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Route</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token annotation punctuation">@Override</span><br>        <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">Request</span> request<span class="token punctuation">,</span><br>                             <span class="token keyword">final</span> <span class="token class-name">Response</span> response<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token class-name">StringWriter</span> writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token keyword">try</span> <span class="token punctuation">{</span><br>                <span class="token class-name">Template</span> helloTemplate <span class="token operator">=</span> configuration<span class="token punctuation">.</span><span class="token function">getTemplate</span><span class="token punctuation">(</span><span class="token string">"hello.ftl"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>                <span class="token class-name">DBObject</span> document <span class="token operator">=</span> collection<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>                helloTemplate<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> writer<span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                <span class="token function">halt</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>            <span class="token keyword">return</span> writer<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p><code>DBObject</code>는 <code>java.util.Map</code>을 구현한 클래스라 <code>Template.process</code> 메서드에 그대로 전달할 수 있다.</p>
<h3>개발하려는 블로그의 관계형 모델</h3>
<p>일반적으로 블로그를 관계형 모델로 개발한다면 다음과 같은 형태가 될 것이다. 게시물 posts, 댓글 comments 등의 엔터티 테이블이 있고 그 사이를 연결해주는 관계 테이블 등이 있다.</p>
<pre><code>posts           comments        tags
------          -----------     -------
post_id         comment_id      tag_id
author_id       name            name
title           comment
post            email
date

post_tags       post_comments       authors
-----------     ---------------     --------
post_id         post_id             author_id
tag_id          comment_id          username
                                    password
</code></pre>
<h3>Mongo 모델</h3>
<p>MongoDB는 JSON 객체를 저장하므로 위의 관계 모델이 적용되지 않고 임의로 데이터를 저장할 수 있다. Posts라는 컬렉션을 만들 것인데 그 안에 작성자, 댓글 등을 모두 넣도록 설계할 수 있다. 이렇듯 스키마 설계시 컬렉션을 분리하느냐 마느냐가 중요한 선택 사항이다. To embed or not to embed, that is the question!</p>
<p>태그나 댓글을 Posts 컬렉션에 넣는 이유는 게시물을 액세스할 때 태그나 댓글도 거의 항상 액세스하기 때문이다.</p>
<p>한편 현실적으로는 16MB가 문서(document)의 한계기 때문에 예를 들어 댓글이 16MB가 넘을 것으로 예상된다면 분리해야 할 수도 있다.</p>

  </div>

  <div class="post-footer">
    <div class="post-footer-date">
      게시일 - <time datetime="2014-07-09T17:06:38.000Z">2014. 7. 10.</time>
    </div>

    <ul class="post-tags"><li><a href="/tags/json">JSON</a></li><li><a href="/tags/mongodb">MongoDB</a></li><li><a href="/tags/nosql">NoSQL</a></li><li><a href="/tags/데이터베이스">데이터베이스</a></li><li><a href="/tags/온라인-강의">온라인 강의</a></li></ul>
  </div>
</div>

<div id="disqus_thread"></div>
<script>
  /**
  *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
  var disqus_config = function () {
    this.page.url = "http://start.goodtime.co.kr/2014/07/mongodb-university-%ea%b0%95%ec%9d%98-1%ea%b0%95-%ea%b0%9c%ec%9a%94/" || location.origin + '/posts/mongodb-university-강의-1강-개요/';
    this.page.identifier = 'mongodb-university-강의-1강-개요';
  };
  (function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = 'https://nnus.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  })();
</script>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.js"></script>

    <script type="module" src="/static/modules/blogInit.js"></script>
    
  </body>
</html>
